"use strict";(self["webpackChunksimple_twitter"]=self["webpackChunksimple_twitter"]||[]).push([[725],{5843:function(t,e,s){s.d(e,{Z:function(){return h}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"modal",class:{show:t.isShow}},[e("div",{staticClass:"modal_container mx-auto"},[e("div",{staticClass:"modal_container-header d-flex"},[e("div",{staticClass:"cancel-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.closeModal.apply(null,arguments)}}},[e("div",{staticClass:"link-icon",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.closeModal.apply(null,arguments)}}}),e("i",{staticClass:"fa-solid fa-xmark size-32"})]),e("h5",[t._v("編輯個人資訊")]),e("button",{staticClass:"btn",attrs:{type:"submit",form:"profile-box",disabled:t.isProcessing}},[t._v("儲存")])]),e("form",{staticClass:"profile-box",attrs:{id:"profile-box"},on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.handleSubmit.apply(null,arguments)}}},[e("div",{staticClass:"user-banner"},[e("div",{staticClass:"filter"}),e("div",{staticClass:"icons"},[t._m(0),e("input",{staticClass:"banner-edit",attrs:{type:"file",id:"coverPhoto",accept:"image/*",name:"coverPhoto"},on:{change:t.handleFileChange}}),e("i",{staticClass:"icon-edit-done",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.defaultCover(t.currentUser.coverPhoto)}}})]),e("img",{attrs:{src:t._f("emptyBanner")(t.user.coverPhoto),alt:""}})]),e("div",{staticClass:"avatar"},[e("div",{staticClass:"filter"}),t._m(1),e("input",{staticClass:"avatar-edit",attrs:{type:"file",id:"avatar",accept:"image/*",name:"avatar"},on:{change:t.handleFileChange}}),e("img",{attrs:{src:t._f("emptyImage")(t.user.avatar),alt:""}})]),e("div",{staticClass:"user-name",class:{error:t.user.name.length>50}},[e("label",{attrs:{for:""}},[t._v("名稱")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.user.name,expression:"user.name"}],attrs:{type:"text",id:"name",name:"name",maxlength:"50",required:""},domProps:{value:t.user.name},on:{input:function(e){e.target.composing||t.$set(t.user,"name",e.target.value)}}})]),e("p",{staticClass:"input-length",class:{error:t.user.name.length>50}},[t._v(t._s(t.user.name.length)+"/50")]),e("div",{staticClass:"user-description",class:{error:t.user.introduction.length>160}},[e("label",{attrs:{for:"introduction"}},[t._v("自我介紹")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.user.introduction,expression:"user.introduction"}],attrs:{id:"introduction",name:"introduction",cols:"30",rows:"10",maxlength:"160",required:""},domProps:{value:t.user.introduction},on:{input:function(e){e.target.composing||t.$set(t.user,"introduction",e.target.value)}}})]),e("p",{staticClass:"input-length",class:{error:t.user.introduction.length>160}},[t._v(t._s(t.user.introduction.length||0)+"/160")])])])])},i=[function(){var t=this,e=t._self._c;return e("label",{attrs:{for:"coverPhoto"}},[e("img",{staticClass:"icon-photo",attrs:{src:s(951),alt:""}})])},function(){var t=this,e=t._self._c;return e("label",{attrs:{for:"avatar"}},[e("img",{staticClass:"icon-photo",attrs:{src:s(951),alt:""}})])}],a=(s(7658),s(8390)),n=s(3507),o=s(629),c={props:{isShow:{type:Boolean},initUser:{type:Object,required:!0}},mixins:[n.Lf],data(){return{user:{},introduction:"",isProcessing:!1}},computed:{...(0,o.rn)(["currentUser","isAuthenticated"])},created(){this.fetchUser()},methods:{fetchUser(){this.user=this.initUser,this.introduction=this.currentUser.introduction,this.user={...this.user,introduction:this.introduction?this.introduction:""}},closeModal(){this.$emit("close-modal",!this.isShow),this.user.name=this.initUser.name,this.user.avatar=this.initUser.avatar,this.user.coverPhoto=this.initUser.coverPhoto,this.user.introduction=this.initUser.introduction||"type something here..."},back(){"user-follow"!==this.$route.name?this.$router.back():this.$router.push({name:"user-page",params:{id:this.currentUser.id}})},handleFileChange(t){const{files:e}=t.target;if(0!==e.length){const s=window.URL.createObjectURL(e[0]);"coverPhoto"===t.target.name?this.user.coverPhoto=s:"avatar"===t.target.name&&(this.user.avatar=s)}else this.image=""},async handleSubmit(t){try{if(0===this.user.name.length||0===this.user.introduction.length)return void n.Z9.warning("內容不可空白");if(this.user.name.length>50||this.user.introduction.length>160)return void n.Z9.warning("字數超過限制");this.isProcessing=!0;const e=t.target,s=new FormData(e),{data:r}=await a.Z.updateProfile(this.initUser.id,s);if("error"===r.status)throw new Error(r.message);this.closeModal(),this.$emit("refresh-user",this.user.id),this.isProcessing=!1}catch(e){this.isProcessing=!1,console.error(e),n.Z9.error("無法儲存變更，請稍後再試")}},defaultCover(t){this.user.coverPhoto=t}},watch:{initUser(t,e){this.user={...this.user,...t}}}},l=c,u=s(1001),d=(0,u.Z)(l,r,i,!1,null,"8e89d376",null),h=d.exports},7863:function(t,e,s){s.d(e,{Z:function(){return u}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-header d-flex align-item-center"},[e("div",{staticClass:"link-icon",on:{click:function(e){return e.preventDefault(),t.back()}}}),e("div",{staticClass:"user-title d-flex justify-content-center"},[e("h5",{staticClass:"user-name"},[t._v(t._s(t.user.name))]),e("div",{staticClass:"user-tweetCounts number-wrap"},[t._v(t._s(t._f("quantifier")(t.user.tweetsLength)))])])])},i=[],a=(s(7658),s(629)),n={props:{user:{name:"",tweetsLength:""}},computed:{...(0,a.rn)(["currentUser","isAuthenticated"])},methods:{back(){this.$router.push("/homepage")}},filters:{quantifier(t){return t+" 推文"}}},o=n,c=s(1001),l=(0,c.Z)(o,r,i,!1,null,"3cdb5850",null),u=l.exports},7725:function(t,e,s){s.r(e),s.d(e,{default:function(){return N}});s(7658);var r=function(){var t=this,e=t._self._c;return e("main",{staticClass:"main-view mx-auto"},[e("NavbarLeft"),t.isLoading?e("LoadingSpinner"):[e("div",{staticClass:"user-page"},[e("UserEdit",{attrs:{"is-show":t.isShow,initUser:t.user},on:{"close-modal":t.closeModal,"refresh-user":t.refreshUser}}),e("UserHeader",{attrs:{user:t.user}}),e("div",{class:["scroll",{"d-none":t.isShow}]},[e("div",{staticClass:"user-profile"},[e("div",{staticClass:"user-banner"},[e("img",{attrs:{src:t._f("emptyBanner")(t.user.coverPhoto),alt:""}})]),e("div",{staticClass:"avatar"},[e("img",{attrs:{src:t._f("emptyImage")(t.user.avatar),alt:""}})]),e("div",{staticClass:"d-flex justify-content-end btn-wrap"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.user.id!==t.currentUser.id,expression:"user.id !== currentUser.id"}],staticClass:"btn email"},[e("a",{attrs:{href:`mailto:${t.user.email}`}})]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.user.id!==t.currentUser.id,expression:"user.id !== currentUser.id"}],staticClass:"btn notify"}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.user.id===t.currentUser.id,expression:"user.id === currentUser.id"}],staticClass:"user-setting",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.openModal.apply(null,arguments)}}},[t._v("編輯個人資料")]),t.user.id===t.currentUser.id||t.user.isFollowed?t._e():e("div",{staticClass:"btn unfollow",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addFollow(t.user.id)}}},[t._v("追蹤")]),t.user.id!==t.currentUser.id&&t.user.isFollowed?e("div",{staticClass:"btn",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteFollow(t.user.id)}}},[t._v("正在追蹤")]):t._e()]),e("div",{staticClass:"user-info"},[e("h5",[t._v(t._s(t.user.name))]),e("div",{staticClass:"user-account number-wrap"},[t._v(t._s(t._f("account")(t.user.account)))]),e("div",{staticClass:"user-description"},[t._v(t._s(t.user.introduction))]),e("div",{staticClass:"user-follow d-flex number-wrap"},[e("div",{staticClass:"user-info-following",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.$router.push({path:`/user/follow/followings/${t.user.id}`})}}},[e("span",[t._v(t._s(t.user.followingCount))]),t._v(" 個跟隨中")]),e("div",{staticClass:"user-info-follower",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.$router.push({path:`/user/follow/followers/${t.user.id}`})}}},[e("span",[t._v(t._s(t.user.followerCount))]),t._v(" 位跟隨者")])])]),e("div",{staticClass:"togglePage d-flex"},[e("div",{staticClass:"userTweets",class:{active:"userTweets"===t.currentContent},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.togglePage("userTweets")}}},[t._v("推文")]),e("div",{staticClass:"userTweets",class:{active:"userReplies"===t.currentContent},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.togglePage("userReplies")}}},[t._v("回覆")]),e("div",{staticClass:"userTweets",class:{active:"userLikes"===t.currentContent},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.togglePage("userLikes")}}},[t._v("喜歡的內容")])])]),"userTweets"===t.currentContent?e("UserTweets",{attrs:{initUser:t.user}}):t._e(),"userReplies"===t.currentContent?e("UserReplies",{attrs:{initUser:t.user}}):t._e(),"userLikes"===t.currentContent?e("UserLikes",{attrs:{initUser:t.user}}):t._e()],1)],1)],e("SuggestUser")],2)},i=[],a=s(1660),n=s(6764),o=function(){var t=this,e=t._self._c;return e("div",[t.isLoading?e("LoadingSpinner"):[0===t.replyTweets.length?e("div",{staticClass:"sweetalert"},[t._v("使用者無任何回覆")]):t._e(),t._l(t.replyTweets,(function(s){return e("div",{key:s.id,staticClass:"comment_wrap d-flex"},[e("div",{staticClass:"avatar_image"},[e("img",{attrs:{src:t._f("emptyImage")(t.initUser.avatar)}})]),e("div",{staticClass:"comment_wrap_body"},[e("div",{staticClass:"d-flex comment_wrap_body--title"},[e("h5",{staticClass:"size-16"},[t._v(t._s(t.initUser.name))]),e("p",{staticClass:"size-14"},[t._v(t._s(t._f("account")(t.initUser.account)))]),t._v(" ・ "),e("span",{staticClass:"size-14"},[t._v(t._s(t._f("fromNow")(s.createdAt)))])]),e("div",{staticClass:"replyAccount size-14"},[t._v("回覆 "),e("span",[e("router-link",{attrs:{to:{name:"user-page",params:{id:s.userData.id}}}},[t._v(t._s(t._f("account")(s.userData.account)))])],1)]),e("div",{staticClass:"comment_wrap_body--content"},[t._v(t._s(s.comment))])])])}))]],2)},c=[],l=s(3507),u=s(629),d=s(8390),h=s(4409),p={data(){return{isShow:!1,replyTweets:[],isLoading:!1}},props:{initUser:{type:Object,required:!0}},mixins:[l.qk,l.Lf,l.$2],computed:{...(0,u.rn)(["currentUser","isAuthenticated"])},created(){this.fetchReplies(this.initUser.id)},methods:{async fetchReplies(t){try{this.isLoading=!0;const{data:e}=await d.Z.getReplies(t);this.replyTweets=e,this.isLoading=!1}catch(e){console.log(e)}}},components:{LoadingSpinner:h.Z}},m=p,v=s(1001),f=(0,v.Z)(m,o,c,!1,null,"114ecd93",null),w=f.exports,g=function(){var t=this,e=t._self._c;return e("div",[t.isLoading?e("LoadingSpinner"):[0===t.favoriteTweets.length?e("div",{staticClass:"sweetalert"},[t._v("使用者無任何喜歡")]):t._e(),t._l(t.favoriteTweets,(function(s){return e("div",{key:s.TweetId,staticClass:"comment_wrap d-flex"},[e("div",{staticClass:"avatar_image"},[e("router-link",{attrs:{to:{name:"user-page",params:{id:s.userData.id}}}},[e("img",{attrs:{src:t._f("emptyImage")(s.userData.avatar)}})])],1),e("div",{staticClass:"comment_wrap_body"},[e("div",{staticClass:"d-flex comment_wrap_body--title"},[e("h5",{staticClass:"size-16"},[e("router-link",{attrs:{to:{name:"user-page",params:{id:s.userData.id}}}},[t._v(t._s(s.userData.name))])],1),e("p",{staticClass:"size-14"},[e("router-link",{attrs:{to:{name:"user-page",params:{id:s.userData.id}}}},[t._v(t._s(t._f("account")(s.userData.account)))])],1),t._v(" ・ "),e("span",{staticClass:"size-14"},[t._v(t._s(t._f("fromNow")(s.createdAt)))])]),e("div",{staticClass:"comment_wrap_body--content mb-3"},[e("router-link",{attrs:{to:{name:"tweet",params:{id:s.TweetId}}}},[t._v(t._s(s.description))])],1),e("div",{staticClass:"comment_wrap_footer d-flex"},[e("div",{staticClass:"comment_wrap_footer--comments-num d-flex mr-10"},[e("div",{staticClass:"icon comment my-auto",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openModal(s)}}}),e("span",{staticClass:"number-wrap"},[t._v(t._s(s.repliedCount))])]),e("div",{staticClass:"comment_wrap_footer--liked-num d-flex"},[e("div",{staticClass:"icon liked my-auto",class:{isliked:s.isLiked},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteLike(s)}}}),e("span",{staticClass:"number-wrap"},[t._v(t._s(s.likedCount))])])])])])})),e("TweetReply",{attrs:{"is-show":t.isShow,tweet:t.targetTweet},on:{"close-modal":t.closeModal,"refresh-replies":t.refreshCommentLength}})]],2)},_=[],C=s(2538),k=s(8431),U={data(){return{isShow:!1,favoriteTweets:[],isLoading:!1,LikesLength:0,targetTweet:{}}},props:{initUser:{type:Object,required:!0}},mixins:[l.qk,l.Lf,l.$2],components:{LoadingSpinner:h.Z,TweetReply:C.Z},methods:{async fetchLikes(t){try{this.isLoading=!0;const{data:e}=await d.Z.getLikes(t);this.favoriteTweets=e,this.LikesLength=e.length,this.isLoading=!1}catch(e){console.log(e),l.Z9.error("按讚失敗，請稍後再試")}},async deleteLike(t){try{const e=t.TweetId,{data:s}=await k.Z.deleteLike({tweetId:e});if("error"===s.status)throw new Error(s.message);this.LikesLength=this.LikesLength-1,this.favoriteTweets=this.favoriteTweets.filter((t=>t.TweetId!==e))}catch(e){console.log(e),l.Z9.error("收回讚失敗，請稍後再試")}},openModal(t){const{createdAt:e,description:s,TweetId:r,userData:i}=t;return this.targetTweet.createdAt=e,this.targetTweet.description=s,this.targetTweet.id=r,this.targetTweet.User=i,this.isShow=!0},closeModal(t){return this.isShow=t},refreshCommentLength(t){this.favoriteTweets.filter((e=>{if(e.TweetId===t)return e.repliedCount=e.repliedCount+1}))}},created(){this.fetchLikes(this.initUser.id)}},A=U,y=(0,v.Z)(A,g,_,!1,null,"9bee33d4",null),L=y.exports,b=function(){var t=this,e=t._self._c;return e("div",[0===t.tweets.length?e("div",{staticClass:"sweetalert"},[t._v("使用者無任何推文")]):t._e(),t._l(t.tweets,(function(s){return e("div",{key:s.id,staticClass:"comment_wrap d-flex"},[e("div",{staticClass:"avatar_image"},[e("img",{attrs:{src:t._f("emptyImage")(t.initUser.avatar)}})]),e("div",{staticClass:"comment_wrap_body"},[e("div",{staticClass:"d-flex comment_wrap_body--title"},[e("h5",{staticClass:"size-16"},[t._v(t._s(t.initUser.name))]),e("p",{staticClass:"size-14"},[t._v(t._s(t._f("account")(t.initUser.account)))]),t._v(" ・ "),e("span",{staticClass:"size-14"},[t._v(t._s(t._f("fromNow")(s.createdAt)))])]),e("div",{staticClass:"comment_wrap_body--content mb-3"},[e("router-link",{attrs:{to:{name:"tweet",params:{id:s.id}}}},[t._v(t._s(s.description))])],1),e("div",{staticClass:"comment_wrap_footer d-flex"},[e("div",{staticClass:"comment_wrap_footer--comments-num d-flex mr-10"},[e("div",{staticClass:"icon comment my-auto",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openModal(s)}}}),e("span",{staticClass:"number-wrap"},[t._v(t._s(s.repliedCount))])]),e("div",{staticClass:"comment_wrap_footer--liked-num d-flex"},[e("div",{staticClass:"icon liked my-auto",class:{isliked:s.isLiked},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleLike(s)}}}),e("span",{staticClass:"number-wrap"},[t._v(t._s(s.likedCount))])])])])])})),e("TweetReply",{attrs:{"is-show":t.isShow,tweet:t.targetTweet},on:{"close-modal":t.closeModal,"refresh-replies":t.refreshAgain}})],2)},x=[],T={data(){return{isShow:!1,tweets:[],targetTweet:{}}},props:{initUser:{type:Object,required:!0}},components:{TweetReply:C.Z},computed:{...(0,u.rn)(["currentUser","isAuthenticated"])},mixins:[l.qk,l.Lf,l.$2],created(){this.fetchTweets(this.initUser.id)},methods:{async fetchTweets(t){const{data:e}=await d.Z.getTweets(t);this.tweets=e},openModal(t){const{createdAt:e,description:s,id:r,userData:i}=t;return this.targetTweet.createdAt=e,this.targetTweet.description=s,this.targetTweet.id=r,this.targetTweet.User=i,this.isShow=!0},closeModal(t){return this.isShow=t},async toggleLike(t){if(!1===t.isLiked)try{const e=t.id,{data:s}=await k.Z.addLike({tweetId:e});if("error"===s.status)throw new Error(s.message);t.likedCount+=1,t.isLiked=!t.isLiked}catch(e){console.log(e),l.Z9.error("按讚失敗，請稍後再試")}else if(!0===t.isLiked)try{const e=t.id,{data:s}=await k.Z.deleteLike({tweetId:e});if("error"===s.status)throw new Error(s.message);t.isLiked=!t.isLiked,t.likedCount-=1}catch(e){console.log(e),l.Z9.error("收回讚失敗，請稍後再試")}},refreshAgain(){const{id:t}=this.$route.params;this.fetchTweets(t)}}},P=T,Z=(0,v.Z)(P,b,x,!1,null,"645253dc",null),S=Z.exports,D=s(5843),I=s(1905),R=s(7863),F={name:"userPage",components:{NavbarLeft:a.Z,SuggestUser:n.Z,UserReplies:w,UserLikes:L,UserTweets:S,UserEdit:D.Z,LoadingSpinner:h.Z,UserHeader:R.Z},mixins:[l.Lf,l.$2],data(){return{user:{id:-1,account:"",email:"",name:"",password:"",role:"",avatar:"",coverPhoto:"",introduction:"",followerCount:0,followingCount:0,tweetsLength:0,isFollowed:!1},currentContent:"userTweets",isShow:!1,isLoading:!1}},created(){const{id:t}=this.$route.params;this.fetchUser(t)},computed:{...(0,u.rn)(["currentUser"])},beforeRouteUpdate(t,e,s){const{id:r}=t.params;this.fetchUser(r),s()},methods:{async fetchUser(t){this.isLoading=!0;const{data:e}=await d.Z.getUser(t),{id:s,account:r,name:i,email:a,avatar:n,coverPhoto:o,introduction:c,followerCount:l,followingCount:u,Tweets:h,isFollowed:p}=e;this.user={...this.user,id:s,account:r,name:i,email:a,avatar:n,coverPhoto:o,introduction:c,followerCount:l,followingCount:u,tweetsLength:h?h.length:0,isFollowed:p},this.isLoading=!1},togglePage(t){this.currentContent=t},openModal(){return this.isShow=!0},closeModal(t){return this.isShow=t},async addFollow(t){try{const{data:e}=await I.Z.addFollow(t);if("error"===e.status)throw new Error(e.message);this.user.isFollowed=!0}catch(e){console.error(e),l.Z9.error("無法加入追蹤，請稍後再試")}},async deleteFollow(t){try{const{data:e}=await I.Z.deleteFollow({userId:t});if("error"===e.status)throw new Error(e.message);this.user.isFollowed=!1}catch(e){console.error(e),l.Z9.error("無法移除追蹤，請稍後再試")}},refreshUser(t){this.fetchUser(t)}},filters:{quantifier(t){return t+" 推文"}}},z=F,M=(0,v.Z)(z,r,i,!1,null,"f7c7154e",null),N=M.exports},951:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFBSURBVHgB3ZVhccMwDIWV3QAUQsZgEBYEhZAxWBi0Q7AOwVIGY5AOQcvAYbAx0J7OcqtLUzuN//T63b1z7MiyJSsO0d3DzAtoBe35hDy/QSXlAAfP0K867aANtNZnwYkNzUF2p85Hneh7pzbpRXRCp5OccV4m5lhbpz6OcwpjvEezgHbGx7Yoih3FN/aCpjZD0u8xrxoaCmvKRM+IQ/9h4iRJxYdWj+iLr62gSxFgrDaVNKTOikB32ZI/G+FTFWhTkaRStBr0v1WWhjIWCPUtu5aqOKgqOkWyzFkgpIZH3oWxP4rwSHF+oJJ8GkShtjtjc4g5SEXQDvpLOk/JO00hUqYNX6YZsb/uQ8Mnv0HzBG3Jp6MnH1ml76KkziAs0qN5pRlMuipysBFI+LVJ31zk+ujPRtn/vRznI5fhvL/cTfIPBN+KksncOFcAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=725.843680d6.js.map